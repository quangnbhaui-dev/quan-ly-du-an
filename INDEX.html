<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qu·∫£n l√Ω D·ª± √°n</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
    }
    
    .header {
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }
    
    .header h1 {
      font-size: 2.2em;
      margin-bottom: 10px;
    }
    
    .main-content {
      padding: 30px;
    }
    
    .tabs {
      display: flex;
      gap: 5px;
      margin-bottom: 30px;
      border-bottom: 2px solid #e0e0e0;
      flex-wrap: wrap;
    }
    
    .tab {
      padding: 12px 20px;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 15px;
      color: #666;
      border-bottom: 3px solid transparent;
      transition: all 0.3s;
      white-space: nowrap;
    }
    
    .tab.active {
      color: #1e3c72;
      border-bottom-color: #1e3c72;
      font-weight: bold;
    }
    
    .tab:hover {
      color: #1e3c72;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #333;
      font-weight: 600;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
    }
    
    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #1e3c72;
    }
    
    .form-group textarea {
      resize: vertical;
      min-height: 100px;
    }
    
    .btn {
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s;
      margin-right: 10px;
      margin-bottom: 10px;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      color: white;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(30, 60, 114, 0.4);
    }
    
    .btn-success {
      background: #27ae60;
      color: white;
    }
    
    .btn-warning {
      background: #f39c12;
      color: white;
    }
    
    .btn-danger {
      background: #e74c3c;
      color: white;
    }
    
    .btn-info {
      background: #3498db;
      color: white;
    }
    
    .btn-small {
      padding: 8px 16px;
      font-size: 14px;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .stat-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 25px;
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      transition: transform 0.3s;
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
    }
    
    .stat-card:nth-child(2) {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }
    
    .stat-card:nth-child(3) {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }
    
    .stat-card:nth-child(4) {
      background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
    }
    
    .stat-card:nth-child(5) {
      background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
    }
    
    .stat-card:nth-child(6) {
      background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
    }
    
    .stat-card.alert {
      background: linear-gradient(135deg, #ff6b6b 0%, #c92a2a 100%);
    }
    
    .stat-number {
      font-size: 2.5em;
      font-weight: bold;
      margin-bottom: 10px;
    }
    
    .stat-label {
      font-size: 0.9em;
      opacity: 0.9;
    }
    
    .project-list {
      display: grid;
      gap: 20px;
    }
    
    .project-card {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 25px;
      border-left: 5px solid #1e3c72;
      transition: all 0.3s;
      position: relative;
    }
    
    .project-card.delayed {
      border-left-color: #e74c3c;
      background: #fff5f5;
    }
    
    .project-card.warning {
      border-left-color: #f39c12;
      background: #fffbf0;
    }
    
    .project-card:hover {
      transform: translateX(5px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .alert-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
    }
    
    .alert-badge.danger {
      background: #e74c3c;
      color: white;
    }
    
    .alert-badge.warning {
      background: #f39c12;
      color: white;
    }
    
    .project-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 15px;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .project-title {
      font-size: 1.4em;
      color: #333;
      font-weight: bold;
    }
    
    .project-code {
      color: #666;
      font-size: 0.9em;
      margin-top: 5px;
    }
    
    .project-status {
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: bold;
    }
    
    .status-quote { background: #fff3cd; color: #856404; }
    .status-design { background: #e2d1f9; color: #5a2d82; }
    .status-production { background: #cce5ff; color: #004085; }
    .status-material { background: #ffd6cc; color: #cc5200; }
    .status-assembly { background: #d1ecf1; color: #0c5460; }
    .status-test { background: #fff0b3; color: #997a00; }
    .status-delivery { background: #d4edda; color: #155724; }
    .status-installation { background: #d1f2eb; color: #0c5460; }
    .status-payment { background: #cfe2ff; color: #084298; }
    .status-completed { background: #28a745; color: white; }
    
    .project-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 15px 0;
      padding: 15px;
      background: white;
      border-radius: 8px;
    }
    
    .info-item {
      display: flex;
      flex-direction: column;
    }
    
    .info-label {
      font-size: 12px;
      color: #888;
      margin-bottom: 5px;
    }
    
    .info-value {
      font-size: 15px;
      color: #333;
      font-weight: 600;
    }
    
    .progress-bar {
      background: #e0e0e0;
      height: 10px;
      border-radius: 10px;
      overflow: hidden;
      margin: 15px 0;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #1e3c72 0%, #2a5298 100%);
      transition: width 0.3s;
    }
    
    .progress-fill.delayed {
      background: linear-gradient(90deg, #e74c3c 0%, #c92a2a 100%);
    }
    
    .progress-fill.warning {
      background: linear-gradient(90deg, #f39c12 0%, #e67e22 100%);
    }
    
    .production-stages {
      margin: 15px 0;
      padding: 15px;
      background: white;
      border-radius: 8px;
    }
    
    .production-stages h4 {
      margin-bottom: 10px;
      color: #333;
    }
    
    .stage-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px;
      margin: 5px 0;
      background: #f8f9fa;
      border-radius: 5px;
    }
    
    .stage-checkbox {
      width: 20px;
      height: 20px;
      cursor: pointer;
    }
    
    .stage-completed {
      background: #d4edda;
      color: #155724;
    }
    
    .timeline {
      margin: 20px 0;
      padding: 15px;
      background: white;
      border-radius: 8px;
    }
    
    .timeline-item {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid #e0e0e0;
    }
    
    .timeline-item:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }
    
    .timeline-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      flex-shrink: 0;
    }
    
    .timeline-content {
      flex: 1;
    }
    
    .timeline-title {
      font-weight: 600;
      color: #333;
      margin-bottom: 5px;
    }
    
    .timeline-date {
      font-size: 12px;
      color: #888;
    }
    
    .project-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }
    
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    
    .modal.active {
      display: flex;
    }
    
    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 15px;
      max-width: 700px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .modal-title {
      font-size: 1.5em;
      color: #333;
    }
    
    .close-modal {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #999;
    }
    
    .search-filter {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    
    .search-filter input,
    .search-filter select {
      flex: 1;
      min-width: 200px;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
    }
    
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #999;
    }
    
    .empty-state-icon {
      font-size: 4em;
      margin-bottom: 20px;
    }
    
    .money {
      color: #27ae60;
      font-weight: bold;
    }
    
    .alert-section {
      background: #fff5f5;
      border: 2px solid #e74c3c;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 30px;
    }
    
    .alert-section h3 {
      color: #e74c3c;
      margin-bottom: 15px;
    }
    
    .warning-section {
      background: #fffbf0;
      border: 2px solid #f39c12;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 30px;
    }
    
    .warning-section h3 {
      color: #f39c12;
      margin-bottom: 15px;
    }
    
    .days-info {
      font-size: 13px;
      color: #666;
      margin-top: 5px;
    }
    
    .days-delayed {
      color: #e74c3c;
      font-weight: bold;
    }
    
    .days-warning {
      color: #f39c12;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üèóÔ∏è H·ªá th·ªëng Qu·∫£n l√Ω D·ª± √°n</h1>
      <p>Qu·∫£n l√Ω to√†n b·ªô quy tr√¨nh: B√°o gi√° ‚Üí Thi·∫øt k·∫ø ‚Üí S·∫£n xu·∫•t (ƒê·∫∑t v·∫≠t t∆∞ ‚Üí L·∫Øp ƒë·∫∑t ‚Üí Test) ‚Üí Giao h√†ng ‚Üí Thi c√¥ng/Thanh to√°n ‚Üí Ho√†n th√†nh</p>
    </div>
    
    <div class="main-content">
      <div class="tabs">
        <button class="tab active" onclick="switchTab('dashboard')">üìä T·ªïng quan</button>
        <button class="tab" onclick="switchTab('monitor')">‚ö†Ô∏è Gi√°m s√°t ti·∫øn ƒë·ªô</button>
        <button class="tab" onclick="switchTab('projects')">üìã D·ª± √°n</button>
        <button class="tab" onclick="switchTab('create')">‚ûï T·∫°o d·ª± √°n</button>
        <button class="tab" onclick="switchTab('quote')">üí∞ B√°o gi√°</button>
        <button class="tab" onclick="switchTab('design')">‚úèÔ∏è Thi·∫øt k·∫ø</button>
        <button class="tab" onclick="switchTab('production')">üè≠ S·∫£n xu·∫•t</button>
        <button class="tab" onclick="switchTab('delivery')">üöö Giao h√†ng</button>
        <button class="tab" onclick="switchTab('installation')">üîß Thi c√¥ng</button>
        <button class="tab" onclick="switchTab('payment')">üí≥ Thanh to√°n</button>
      </div>
      
      <!-- Dashboard Tab -->
      <div id="dashboard" class="tab-content active">
        <h2 style="margin-bottom: 20px;">Th·ªëng k√™ t·ªïng quan</h2>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number" id="totalProjects">0</div>
            <div class="stat-label">T·ªïng d·ª± √°n</div>
          </div>
          <div class="stat-card alert" onclick="switchTab('monitor'); document.querySelectorAll('.tab')[1].classList.add('active'); document.querySelectorAll('.tab')[0].classList.remove('active');">
            <div class="stat-number" id="delayedProjects">0</div>
            <div class="stat-label">‚ö†Ô∏è Ch·∫≠m ti·∫øn ƒë·ªô</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="quoteProjects">0</div>
            <div class="stat-label">B√°o gi√°</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="designProjects">0</div>
            <div class="stat-label">Thi·∫øt k·∫ø</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="productionProjects">0</div>
            <div class="stat-label">S·∫£n xu·∫•t</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="completedProjects">0</div>
            <div class="stat-label">Ho√†n th√†nh</div>
          </div>
        </div>
        
        <h3 style="margin: 30px 0 20px 0;">üìà D·ª± √°n g·∫ßn ƒë√¢y</h3>
        <div id="recentProjects"></div>
      </div>
      
      <!-- Monitor Tab -->
      <div id="monitor" class="tab-content">
        <h2 style="margin-bottom: 20px;">‚ö†Ô∏è Gi√°m s√°t Ti·∫øn ƒë·ªô D·ª± √°n</h2>
        
        <div class="alert-section" id="delayedSection">
          <h3>üö® D·ª± √°n ch·∫≠m ti·∫øn ƒë·ªô</h3>
          <div id="delayedList"></div>
        </div>
        
        <div class="warning-section" id="warningSection">
          <h3>‚ö†Ô∏è D·ª± √°n c√≥ nguy c∆° ch·∫≠m ti·∫øn ƒë·ªô</h3>
          <div id="warningList"></div>
        </div>
        
        <div id="onTrackSection">
          <h3 style="margin-bottom: 15px; color: #27ae60;">‚úÖ D·ª± √°n ƒë√∫ng ti·∫øn ƒë·ªô</h3>
          <div id="onTrackList"></div>
        </div>
      </div>
      
      <!-- Projects Tab -->
      <div id="projects" class="tab-content">
        <h2 style="margin-bottom: 20px;">Danh s√°ch d·ª± √°n</h2>
        <div class="search-filter">
          <input type="text" id="searchInput" placeholder="üîç T√¨m ki·∫øm d·ª± √°n..." onkeyup="filterProjects()">
          <select id="statusFilter" onchange="filterProjects()">
            <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
            <option value="quote">B√°o gi√°</option>
            <option value="design">Thi·∫øt k·∫ø</option>
            <option value="production">S·∫£n xu·∫•t</option>
            <option value="material">ƒê·∫∑t v·∫≠t t∆∞</option>
            <option value="assembly">L·∫Øp ƒë·∫∑t</option>
            <option value="test">Test xu·∫•t x∆∞·ªüng</option>
            <option value="delivery">Giao h√†ng</option>
            <option value="installation">Thi c√¥ng l·∫Øp ƒë·∫∑t</option>
            <option value="payment">Thanh to√°n</option>
            <option value="completed">Ho√†n th√†nh</option>
          </select>
        </div>
        <div id="projectList" class="project-list"></div>
      </div>
      
      <!-- Create Tab -->
      <div id="create" class="tab-content">
        <h2 style="margin-bottom: 20px;">T·∫°o d·ª± √°n m·ªõi</h2>
        <form id="projectForm" onsubmit="addProject(event)">
          <div class="form-row">
            <div class="form-group">
              <label>M√£ d·ª± √°n *</label>
              <input type="text" id="projectCode" required placeholder="VD: DA-2024-001">
            </div>
            
            <div class="form-group">
              <label>T√™n d·ª± √°n *</label>
              <input type="text" id="projectName" required placeholder="T√™n d·ª± √°n">
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>Kh√°ch h√†ng *</label>
              <input type="text" id="projectClient" required placeholder="T√™n kh√°ch h√†ng">
            </div>
            
            <div class="form-group">
              <label>S·ªë ƒëi·ªán tho·∫°i</label>
              <input type="tel" id="projectPhone" placeholder="0123456789">
            </div>
          </div>
          
          <div class="form-group">
            <label>ƒê·ªãa ch·ªâ d·ª± √°n</label>
            <input type="text" id="projectAddress" placeholder="ƒê·ªãa ch·ªâ">
          </div>
          
          <div class="form-group">
            <label>M√¥ t·∫£ d·ª± √°n</label>
            <textarea id="projectDescription" placeholder="M√¥ t·∫£ chi ti·∫øt v·ªÅ d·ª± √°n..."></textarea>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>Gi√° tr·ªã d·ª± √°n (VNƒê)</label>
              <input type="number" id="projectValue" placeholder="0" min="0">
            </div>
            
            <div class="form-group">
              <label>Ng√†y b·∫Øt ƒë·∫ßu *</label>
              <input type="date" id="projectStartDate" required>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>Ng√†y d·ª± ki·∫øn ho√†n th√†nh *</label>
              <input type="date" id="projectEndDate" required>
            </div>
            
            <div class="form-group">
              <label>Ng∆∞·ªùi ph·ª• tr√°ch</label>
              <input type="text" id="projectManager" placeholder="T√™n ng∆∞·ªùi ph·ª• tr√°ch">
            </div>
          </div>
          
          <button type="submit" class="btn btn-primary">‚úÖ T·∫°o d·ª± √°n</button>
        </form>
      </div>
      
      <!-- Quote Tab -->
      <div id="quote" class="tab-content">
        <h2 style="margin-bottom: 20px;">üí∞ Qu·∫£n l√Ω B√°o gi√°</h2>
        <div id="quoteList"></div>
      </div>
      
      <!-- Design Tab -->
      <div id="design" class="tab-content">
        <h2 style="margin-bottom: 20px;">‚úèÔ∏è Qu·∫£n l√Ω Thi·∫øt k·∫ø</h2>
        <div id="designList"></div>
      </div>
      
      <!-- Production Tab -->
      <div id="production" class="tab-content">
        <h2 style="margin-bottom: 20px;">üè≠ Qu·∫£n l√Ω S·∫£n xu·∫•t</h2>
        <div id="productionList"></div>
      </div>
      
      <!-- Delivery Tab -->
      <div id="delivery" class="tab-content">
        <h2 style="margin-bottom: 20px;">üöö Qu·∫£n l√Ω Giao h√†ng</h2>
        <div id="deliveryList"></div>
      </div>
      
      <!-- Installation Tab -->
      <div id="installation" class="tab-content">
        <h2 style="margin-bottom: 20px;">üîß Qu·∫£n l√Ω Thi c√¥ng l·∫Øp ƒë·∫∑t</h2>
        <div id="installationList"></div>
      </div>
      
      <!-- Payment Tab -->
      <div id="payment" class="tab-content">
        <h2 style="margin-bottom: 20px;">üí≥ Qu·∫£n l√Ω Thanh to√°n</h2>
        <div id="paymentList"></div>
      </div>
    </div>
  </div>
  
  <!-- Modal for Project Details -->
  <div id="projectModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Chi ti·∫øt d·ª± √°n</h2>
        <button class="close-modal" onclick="closeModal()">√ó</button>
      </div>
      <div id="modalBody"></div>
    </div>
  </div>
  
  <script>
    let projects = JSON.parse(localStorage.getItem('projects')) || [];
    
    const statusMap = {
      'quote': 'B√°o gi√°',
      'design': 'Thi·∫øt k·∫ø',
      'production': 'S·∫£n xu·∫•t',
      'material': 'ƒê·∫∑t v·∫≠t t∆∞',
      'assembly': 'L·∫Øp ƒë·∫∑t',
      'test': 'Test xu·∫•t x∆∞·ªüng',
      'delivery': 'Giao h√†ng',
      'installation': 'Thi c√¥ng l·∫Øp ƒë·∫∑t',
      'payment': 'Thanh to√°n',
      'completed': 'Ho√†n th√†nh'
    };
    
    const progressMap = {
      'quote': 10,
      'design': 20,
      'production': 30,
      'material': 40,
      'assembly': 50,
      'test': 60,
      'delivery': 70,
      'installation': 80,
      'payment': 90,
      'completed': 100
    };
    
    function switchTab(tabName) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      
      event.target.classList.add('active');
      document.getElementById(tabName).classList.add('active');
      
      if (tabName === 'projects') {
        renderProjects();
      } else if (tabName === 'dashboard') {
        updateDashboard();
      } else if (tabName === 'monitor') {
        renderMonitor();
      } else if (tabName === 'quote') {
        renderQuoteList();
      } else if (tabName === 'design') {
        renderDesignList();
      } else if (tabName === 'production') {
        renderProductionList();
      } else if (tabName === 'delivery') {
        renderDeliveryList();
      } else if (tabName === 'installation') {
        renderInstallationList();
      } else if (tabName === 'payment') {
        renderPaymentList();
      }
    }
    
    function calculateDaysRemaining(endDate) {
      if (!endDate) return null;
      const today = new Date();
      const end = new Date(endDate);
      const diffTime = end - today;
      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
      return diffDays;
    }
    
    function getProjectStatus(project) {
      if (project.status === 'completed') return 'completed';
      
      const daysRemaining = calculateDaysRemaining(project.endDate);
      if (daysRemaining === null) return 'normal';
      
      if (daysRemaining < 0) return 'delayed';
      if (daysRemaining <= 3) return 'warning';
      return 'normal';
    }
    
    function addProject(event) {
      event.preventDefault();
      
      const project = {
        id: Date.now(),
        code: document.getElementById('projectCode').value,
        name: document.getElementById('projectName').value,
        client: document.getElementById('projectClient').value,
        phone: document.getElementById('projectPhone').value,
        address: document.getElementById('projectAddress').value,
        description: document.getElementById('projectDescription').value,
        value: document.getElementById('projectValue').value,
        startDate: document.getElementById('projectStartDate').value,
        endDate: document.getElementById('projectEndDate').value,
        manager: document.getElementById('projectManager').value,
        status: 'quote',
        needsInstallation: true,
        productionStages: {
          material: false,
          assembly: false,
          test: false
        },
        createdAt: new Date().toLocaleDateString('vi-VN'),
        timeline: [
          { stage: 'quote', date: new Date().toLocaleDateString('vi-VN'), note: 'D·ª± √°n ƒë∆∞·ª£c t·∫°o - Giai ƒëo·∫°n b√°o gi√°' }
        ]
      };
      
      projects.push(project);
      localStorage.setItem('projects', JSON.stringify(projects));
      
      document.getElementById('projectForm').reset();
      alert('‚úÖ ƒê√£ t·∫°o d·ª± √°n th√†nh c√¥ng!');
      
      switchTab('projects');
      document.querySelectorAll('.tab')[2].classList.add('active');
      document.querySelectorAll('.tab')[3].classList.remove('active');
    }
    
    function renderProjects() {
      const projectList = document.getElementById('projectList');
      
      if (projects.length === 0) {
        projectList.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">üìã</div>
            <h3>Ch∆∞a c√≥ d·ª± √°n n√†o</h3>
            <p>H√£y t·∫°o d·ª± √°n ƒë·∫ßu ti√™n c·ªßa b·∫°n!</p>
          </div>
        `;
        return;
      }
      
      projectList.innerHTML = projects.map(project => renderProjectCard(project)).join('');
    }
    
    function renderProjectCard(project) {
      const progress = progressMap[project.status];
      const projectStatus = getProjectStatus(project);
      const daysRemaining = calculateDaysRemaining(project.endDate);
      
      let alertBadge = '';
      let cardClass = 'project-card';
      let progressClass = '';
      let daysInfo = '';
      
      if (projectStatus === 'delayed') {
        alertBadge = '<div class="alert-badge danger">üö® Tr·ªÖ h·∫°n</div>';
        cardClass += ' delayed';
        progressClass = 'delayed';
        daysInfo = `<div class="days-info days-delayed">‚ö†Ô∏è Tr·ªÖ ${Math.abs(daysRemaining)} ng√†y</div>`;
      } else if (projectStatus === 'warning') {
        alertBadge = '<div class="alert-badge warning">‚ö†Ô∏è S·∫Øp h·∫øt h·∫°n</div>';
        cardClass += ' warning';
        progressClass = 'warning';
        daysInfo = `<div class="days-info days-warning">‚è∞ C√≤n ${daysRemaining} ng√†y</div>`;
      } else if (project.status !== 'completed' && daysRemaining !== null) {
        daysInfo = `<div class="days-info">üìÖ C√≤n ${daysRemaining} ng√†y</div>`;
      }
      
      let productionStagesHTML = '';
      
      if (['production', 'material', 'assembly', 'test'].includes(project.status)) {
        productionStagesHTML = `
          <div class="production-stages">
            <h4>üè≠ Giai ƒëo·∫°n s·∫£n xu·∫•t:</h4>
            <div class="stage-item ${project.productionStages.material ? 'stage-completed' : ''}">
              <input type="checkbox" class="stage-checkbox" ${project.productionStages.material ? 'checked' : ''} 
                onchange="updateProductionStage(${project.id}, 'material', this.checked)">
              <span>üì¶ ƒê·∫∑t v·∫≠t t∆∞</span>
            </div>
            <div class="stage-item ${project.productionStages.assembly ? 'stage-completed' : ''}">
              <input type="checkbox" class="stage-checkbox" ${project.productionStages.assembly ? 'checked' : ''} 
                onchange="updateProductionStage(${project.id}, 'assembly', this.checked)">
              <span>üîß L·∫Øp ƒë·∫∑t</span>
            </div>
            <div class="stage-item ${project.productionStages.test ? 'stage-completed' : ''}">
              <input type="checkbox" class="stage-checkbox" ${project.productionStages.test ? 'checked' : ''} 
                onchange="updateProductionStage(${project.id}, 'test', this.checked)">
              <span>‚úÖ Test xu·∫•t x∆∞·ªüng</span>
            </div>
          </div>
        `;
      }
      
      return `
        <div class="${cardClass}">
          ${alertBadge}
          <div class="project-header">
            <div>
              <div class="project-title">${project.name}</div>
              <div class="project-code">M√£: ${project.code}</div>
            </div>
            <div class="project-status status-${project.status}">
              ${statusMap[project.status]}
            </div>
          </div>
          
          <div class="project-info">
            <div class="info-item">
              <div class="info-label">Kh√°ch h√†ng</div>
              <div class="info-value">üë§ ${project.client}</div>
            </div>
            <div class="info-item">
              <div class="info-label">Gi√° tr·ªã</div>
              <div class="info-value money">${formatMoney(project.value)} VNƒê</div>
            </div>
            <div class="info-item">
              <div class="info-label">Ng∆∞·ªùi ph·ª• tr√°ch</div>
              <div class="info-value">üë®‚Äçüíº ${project.manager || 'Ch∆∞a ph√¢n c√¥ng'}</div>
            </div>
            <div class="info-item">
              <div class="info-label">H·∫°n ho√†n th√†nh</div>
              <div class="info-value">üìÖ ${project.endDate || 'Ch∆∞a x√°c ƒë·ªãnh'}</div>
            </div>
          </div>
          
          ${productionStagesHTML}
          
          <div class="progress-bar">
            <div class="progress-fill ${progressClass}" style="width: ${progress}%"></div>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 5px;">
            <div style="font-size: 12px; color: #888;">Ti·∫øn ƒë·ªô: ${progress}%</div>
            ${daysInfo}
          </div>
          
          <div class="project-actions">
            <button class="btn btn-primary btn-small" onclick="viewProject(${project.id})">üëÅÔ∏è Chi ti·∫øt</button>
            ${getActionButtons(project)}
            <button class="btn btn-danger btn-small" onclick="deleteProject(${project.id})">üóëÔ∏è X√≥a</button>
          </div>
        </div>
      `;
    }
    
    function getActionButtons(project) {
      const buttons = {
        'quote': '<button class="btn btn-success btn-small" onclick="updateStatus(' + project.id + ', \'design\')">‚úèÔ∏è Chuy·ªÉn sang Thi·∫øt k·∫ø</button>',
        'design': '<button class="btn btn-success btn-small" onclick="updateStatus(' + project.id + ', \'production\')">üè≠ B·∫Øt ƒë·∫ßu S·∫£n xu·∫•t</button>',
        'production': '<button class="btn btn-info btn-small" onclick="updateStatus(' + project.id + ', \'material\')">üì¶ ƒê·∫∑t v·∫≠t t∆∞</button>',
        'material': '<button class="btn btn-info btn-small" onclick="updateStatus(' + project.id + ', \'assembly\')">üîß L·∫Øp ƒë·∫∑t</button>',
        'assembly': '<button class="btn btn-info btn-small" onclick="updateStatus(' + project.id + ', \'test\')">‚úÖ Test xu·∫•t x∆∞·ªüng</button>',
        'test': '<button class="btn btn-success btn-small" onclick="updateStatus(' + project.id + ', \'delivery\')">üöö Giao h√†ng</button>',
        'delivery': '<button class="btn btn-success btn-small" onclick="updateStatus(' + project.id + ', \'installation\')">üîß Thi c√¥ng l·∫Øp ƒë·∫∑t</button>' +
                    '<button class="btn btn-warning btn-small" onclick="updateStatus(' + project.id + ', \'payment\')">üí≥ Thanh to√°n tr·ª±c ti·∫øp</button>',
        'installation': '<button class="btn btn-success btn-small" onclick="updateStatus(' + project.id + ', \'payment\')">üí≥ Thanh to√°n</button>',
        'payment': '<button class="btn btn-success btn-small" onclick="updateStatus(' + project.id + ', \'completed\')">‚úÖ Ho√†n th√†nh</button>',
        'completed': '<button class="btn btn-success btn-small" disabled>‚úÖ ƒê√£ ho√†n th√†nh</button>'
      };
      return buttons[project.status] || '';
    }
    
    function updateStatus(id, newStatus) {
      projects = projects.map(p => {
        if (p.id === id) {
          p.status = newStatus;
          p.timeline.push({
            stage: newStatus,
            date: new Date().toLocaleDateString('vi-VN'),
            note: `Chuy·ªÉn sang giai ƒëo·∫°n ${statusMap[newStatus]}`
          });
        }
        return p;
      });
      localStorage.setItem('projects', JSON.stringify(projects));
      renderProjects();
      updateDashboard();
      alert('‚úÖ ƒê√£ c·∫≠p nh·∫≠t tr·∫°ng th√°i d·ª± √°n!');
    }
    
    function updateProductionStage(id, stage, checked) {
      projects = projects.map(p => {
        if (p.id === id) {
          p.productionStages[stage] = checked;
          p.timeline.push({
            stage: stage,
            date: new Date().toLocaleDateString('vi-VN'),
            note: `${checked ? 'Ho√†n th√†nh' : 'H·ªßy'} giai ƒëo·∫°n ${statusMap[stage]}`
          });
        }
        return p;
      });
      localStorage.setItem('projects', JSON.stringify(projects));
      renderProjects();
    }
    
    function deleteProject(id) {
      if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a d·ª± √°n n√†y?')) {
        projects = projects.filter(p => p.id !== id);
        localStorage.setItem('projects', JSON.stringify(projects));
        renderProjects();
        updateDashboard();
      }
    }
    
    function viewProject(id) {
      const project = projects.find(p => p.id === id);
      if (!project) return;
      
      const projectStatus = getProjectStatus(project);
      const daysRemaining = calculateDaysRemaining(project.endDate);
      let statusInfo = '';
      
      if (projectStatus === 'delayed') {
        statusInfo = `<div style="background: #fff5f5; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #e74c3c;">
          <strong style="color: #e74c3c;">üö® D·ª± √°n ƒë√£ tr·ªÖ h·∫°n ${Math.abs(daysRemaining)} ng√†y!</strong>
        </div>`;
      } else if (projectStatus === 'warning') {
        statusInfo = `<div style="background: #fffbf0; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #f39c12;">
          <strong style="color: #f39c12;">‚ö†Ô∏è D·ª± √°n s·∫Øp h·∫øt h·∫°n - C√≤n ${daysRemaining} ng√†y!</strong>
        </div>`;
      }
      
      const modalBody = document.getElementById('modalBody');
      modalBody.innerHTML = `
        ${statusInfo}
        
        <div class="project-info">
          <div class="info-item">
            <div class="info-label">M√£ d·ª± √°n</div>
            <div class="info-value">${project.code}</div>
          </div>
          <div class="info-item">
            <div class="info-label">T√™n d·ª± √°n</div>
            <div class="info-value">${project.name}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Kh√°ch h√†ng</div>
            <div class="info-value">${project.client}</div>
          </div>
          <div class="info-item">
            <div class="info-label">S·ªë ƒëi·ªán tho·∫°i</div>
            <div class="info-value">${project.phone || 'Ch∆∞a c√≥'}</div>
          </div>
          <div class="info-item">
            <div class="info-label">ƒê·ªãa ch·ªâ</div>
            <div class="info-value">${project.address || 'Ch∆∞a c√≥'}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Gi√° tr·ªã</div>
            <div class="info-value money">${formatMoney(project.value)} VNƒê</div>
          </div>
          <div class="info-item">
            <div class="info-label">Ng∆∞·ªùi ph·ª• tr√°ch</div>
            <div class="info-value">${project.manager || 'Ch∆∞a ph√¢n c√¥ng'}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Tr·∫°ng th√°i</div>
            <div class="info-value">${statusMap[project.status]}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Ng√†y b·∫Øt ƒë·∫ßu</div>
            <div class="info-value">${project.startDate || 'Ch∆∞a x√°c ƒë·ªãnh'}</div>
          </div>
          <div class="info-item">
            <div class="info-label">H·∫°n ho√†n th√†nh</div>
            <div class="info-value">${project.endDate || 'Ch∆∞a x√°c ƒë·ªãnh'}</div>
          </div>
        </div>
        
        <div style="margin: 20px 0;">
          <strong>M√¥ t·∫£:</strong>
          <p style="margin-top: 10px; color: #666;">${project.description || 'Kh√¥ng c√≥ m√¥ t·∫£'}</p>
        </div>
        
        <div class="production-stages">
          <h4>üè≠ Ti·∫øn ƒë·ªô s·∫£n xu·∫•t:</h4>
          <div class="stage-item ${project.productionStages.material ? 'stage-completed' : ''}">
            <span>${project.productionStages.material ? '‚úÖ' : '‚è≥'} ƒê·∫∑t v·∫≠t t∆∞</span>
          </div>
          <div class="stage-item ${project.productionStages.assembly ? 'stage-completed' : ''}">
            <span>${project.productionStages.assembly ? '‚úÖ' : '‚è≥'} L·∫Øp ƒë·∫∑t</span>
          </div>
          <div class="stage-item ${project.productionStages.test ? 'stage-completed' : ''}">
            <span>${project.productionStages.test ? '‚úÖ' : '‚è≥'} Test xu·∫•t x∆∞·ªüng</span>
          </div>
        </div>
        
        <div class="timeline">
          <h3 style="margin-bottom: 15px;">üìÖ L·ªãch s·ª≠ d·ª± √°n</h3>
          ${project.timeline.map(item => `
            <div class="timeline-item">
              <div class="timeline-icon" style="background: #1e3c72; color: white;">
                ${getStageIcon(item.stage)}
              </div>
              <div class="timeline-content">
                <div class="timeline-title">${statusMap[item.stage] || item.stage}</div>
                <div class="timeline-date">${item.date} - ${item.note}</div>
              </div>
            </div>
          `).join('')}
        </div>
      `;
      
      document.getElementById('projectModal').classList.add('active');
    }
    
    function closeModal() {
      document.getElementById('projectModal').classList.remove('active');
    }
    
    function getStageIcon(stage) {
      const icons = {
        'quote': 'üí∞',
        'design': '‚úèÔ∏è',
        'production': 'üè≠',
        'material': 'üì¶',
        'assembly': 'üîß',
        'test': '‚úÖ',
        'delivery': 'üöö',
        'installation': 'üîß',
        'payment': 'üí≥',
        'completed': '‚úÖ'
      };
      return icons[stage] || 'üìå';
    }
    
    function filterProjects() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const statusFilter = document.getElementById('statusFilter').value;
      
      let filtered = projects.filter(p => {
        const matchSearch = p.name.toLowerCase().includes(searchTerm) ||
                          p.code.toLowerCase().includes(searchTerm) ||
                          p.client.toLowerCase().includes(searchTerm);
        const matchStatus = !statusFilter || p.status === statusFilter;
        return matchSearch && matchStatus;
      });
      
      const projectList = document.getElementById('projectList');
      if (filtered.length === 0) {
        projectList.innerHTML = '<div class="empty-state"><p>Kh√¥ng t√¨m th·∫•y d·ª± √°n n√†o</p></div>';
      } else {
        projectList.innerHTML = filtered.map(project => renderProjectCard(project)).join('');
      }
    }
    
    function renderMonitor() {
      const activeProjects = projects.filter(p => p.status !== 'completed');
      
      const delayed = activeProjects.filter(p => getProjectStatus(p) === 'delayed');
      const warning = activeProjects.filter(p => getProjectStatus(p) === 'warning');
      const onTrack = activeProjects.filter(p => getProjectStatus(p) === 'normal');
      
      const delayedList = document.getElementById('delayedList');
      const warningList = document.getElementById('warningList');
      const onTrackList = document.getElementById('onTrackList');
      
      if (delayed.length === 0) {
        delayedList.innerHTML = '<p style="color: #999;">Kh√¥ng c√≥ d·ª± √°n n√†o ch·∫≠m ti·∫øn ƒë·ªô</p>';
      } else {
        delayedList.innerHTML = delayed.map(p => renderProjectCard(p)).join('');
      }
      
      if (warning.length === 0) {
        warningList.innerHTML = '<p style="color: #999;">Kh√¥ng c√≥ d·ª± √°n n√†o c√≥ nguy c∆° ch·∫≠m ti·∫øn ƒë·ªô</p>';
      } else {
        warningList.innerHTML = warning.map(p => renderProjectCard(p)).join('');
      }
      
      if (onTrack.length === 0) {
        onTrackList.innerHTML = '<p style="color: #999;">Kh√¥ng c√≥ d·ª± √°n n√†o ƒëang th·ª±c hi·ªán</p>';
      } else {
        onTrackList.innerHTML = onTrack.map(p => renderProjectCard(p)).join('');
      }
    }
    
    function updateDashboard() {
      const activeProjects = projects.filter(p => p.status !== 'completed');
      const delayed = activeProjects.filter(p => getProjectStatus(p) === 'delayed');
      
      document.getElementById('totalProjects').textContent = projects.length;
      document.getElementById('delayedProjects').textContent = delayed.length;
      document.getElementById('quoteProjects').textContent = projects.filter(p => p.status === 'quote').length;
      document.getElementById('designProjects').textContent = projects.filter(p => p.status === 'design').length;
      document.getElementById('productionProjects').textContent = projects.filter(p => ['production', 'material', 'assembly', 'test'].includes(p.status)).length;
      document.getElementById('completedProjects').textContent = projects.filter(p => p.status === 'completed').length;
      
      const recent = projects.slice(-3).reverse();
      document.getElementById('recentProjects').innerHTML = recent.length > 0 ? recent.map(p => renderProjectCard(p)).join('') : '<div class="empty-state"><p>Ch∆∞a c√≥ d·ª± √°n n√†o</p></div>';
    }
    
    function renderQuoteList() {
      const quoteProjects = projects.filter(p => p.status === 'quote');
      const list = document.getElementById('quoteList');
      if (quoteProjects.length === 0) {
        list.innerHTML = '<div class="empty-state"><p>Kh√¥ng c√≥ d·ª± √°n n√†o ƒëang trong giai ƒëo·∫°n b√°o gi√°</p></div>';
      } else {
        list.innerHTML = quoteProjects.map(p => renderProjectCard(p)).join('');
      }
    }
    
    function renderDesignList() {
      const designProjects = projects.filter(p => p.status === 'design');
      const list = document.getElementById('designList');
      if (designProjects.length === 0) {
        list.innerHTML = '<div class="empty-state"><p>Kh√¥ng c√≥ d·ª± √°n n√†o ƒëang thi·∫øt k·∫ø</p></div>';
      } else {
        list.innerHTML = designProjects.map(p => renderProjectCard(p)).join('');
      }
    }
    
    function renderProductionList() {
      const productionProjects = projects.filter(p => ['production', 'material', 'assembly', 'test'].includes(p.status));
      const list = document.getElementById('productionList');
      if (productionProjects.length === 0) {
        list.innerHTML = '<div class="empty-state"><p>Kh√¥ng c√≥ d·ª± √°n n√†o ƒëang s·∫£n xu·∫•t</p></div>';
      } else {
        list.innerHTML = productionProjects.map(p => renderProjectCard(p)).join('');
      }
    }
    
    function renderDeliveryList() {
      const deliveryProjects = projects.filter(p => p.status === 'delivery');
      const list = document.getElementById('deliveryList');
      if (deliveryProjects.length === 0) {
        list.innerHTML = '<div class="empty-state"><p>Kh√¥ng c√≥ d·ª± √°n n√†o ƒëang giao h√†ng</p></div>';
      } else {
        list.innerHTML = deliveryProjects.map(p => renderProjectCard(p)).join('');
      }
    }
    
    function renderInstallationList() {
      const installationProjects = projects.filter(p => p.status === 'installation');
      const list = document.getElementById('installationList');
      if (installationProjects.length === 0) {
        list.innerHTML = '<div class="empty-state"><p>Kh√¥ng c√≥ d·ª± √°n n√†o ƒëang thi c√¥ng l·∫Øp ƒë·∫∑t</p></div>';
      } else {
        list.innerHTML = installationProjects.map(p => renderProjectCard(p)).join('');
      }
    }
    
    function renderPaymentList() {
      const paymentProjects = projects.filter(p => p.status === 'payment');
      const list = document.getElementById('paymentList');
      if (paymentProjects.length === 0) {
        list.innerHTML = '<div class="empty-state"><p>Kh√¥ng c√≥ d·ª± √°n n√†o ƒëang ch·ªù thanh to√°n</p></div>';
      } else {
        list.innerHTML = paymentProjects.map(p => renderProjectCard(p)).join('');
      }
    }
    
    function formatMoney(value) {
      if (!value) return '0';
      return parseInt(value).toLocaleString('vi-VN');
    }
    
    // Initialize
    updateDashboard();
  </script>
</body>
</html>